<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RARO Protocol v2</title>
    <style>
        :root {
            --bg: #050505;
            --cyan: #00F0FF;
            --red: #FF3E3E;
            --dim: #1a1a1a;
            --font-mono: 'JetBrains Mono', monospace;
        }

        body {
            margin: 0; background: var(--bg); height: 100vh;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; font-family: var(--font-mono);
        }

        /* HUD ELEMENTS */
        .corner {
            position: absolute; width: 40px; height: 40px;
            border: 1px solid var(--dim); transition: all 0.8s ease;
            opacity: 0.5;
        }
        .tl { top: 40px; left: 40px; border-right: 0; border-bottom: 0; }
        .tr { top: 40px; right: 40px; border-left: 0; border-bottom: 0; }
        .bl { bottom: 40px; left: 40px; border-right: 0; border-top: 0; }
        .br { bottom: 40px; right: 40px; border-left: 0; border-top: 0; }

        .stage.locked .corner { border-color: var(--cyan); width: 60px; height: 60px; opacity: 1; }

        /* PARTICLE SYSTEM */
        .dot {
            position: absolute;
            width: 4px; height: 4px;
            background: var(--red);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--red);
            transition: 
                transform 1.2s cubic-bezier(0.22, 1, 0.36, 1),
                background 0.4s ease,
                box-shadow 0.4s ease,
                border-radius 0.4s ease;
            z-index: 5;
        }

        /* SCAN LINE */
        .scanner {
            position: absolute; top: -100%; left: 0;
            width: 100%; height: 2px;
            background: var(--cyan);
            box-shadow: 0 0 20px var(--cyan);
            opacity: 0;
            z-index: 10;
        }

        .stage.scanning .scanner {
            animation: scan 1.5s cubic-bezier(0.45, 0, 0.55, 1) forwards;
            opacity: 1;
        }

        @keyframes scan {
            0% { top: 0% }
            100% { top: 100% }
        }

        /* TEXTUAL READOUTS */
        .label {
            position: absolute;
            font-size: 10px; font-weight: bold;
            letter-spacing: 5px; text-transform: uppercase;
            color: var(--red); opacity: 0;
            transition: all 0.5s ease;
        }

        .stage.forming .label { opacity: 0.4; }
        .stage.locked .label { color: var(--cyan); opacity: 1; text-shadow: 0 0 10px var(--cyan); }

        .top-label { top: 15%; }
        .bottom-label { bottom: 15%; }

        .readout-panel {
            position: absolute; right: 80px; top: 50%;
            transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 20px;
        }

        .readout {
            font-size: 9px; color: var(--cyan);
            opacity: 0; transform: translateX(30px);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .stage.locked .readout { opacity: 0.7; transform: translateX(0); }
        .readout:nth-child(1) { transition-delay: 1.0s; }
        .readout:nth-child(2) { transition-delay: 1.2s; }
        .readout:nth-child(3) { transition-delay: 1.4s; }

        /* CENTER HEX GRID (Visual Anchor) */
        .hex-bg {
            position: absolute; width: 400px; height: 400px;
            border: 1px solid var(--cyan); border-radius: 50%;
            opacity: 0; transform: scale(0.8);
            transition: all 1s var(--ease-snap);
        }
        .stage.locked .hex-bg { opacity: 0.1; transform: scale(1); border-width: 5px; }

    </style>
</head>
<body>

    <div id="main-stage" class="stage">
        
        <div class="scanner"></div>

        <!-- HUD -->
        <div class="corner tl"></div>
        <div class="corner tr"></div>
        <div class="corner bl"></div>
        <div class="corner br"></div>

        <div class="hex-bg"></div>

        <div class="top-label label" id="status-text">Stochastic_Noise_Detected</div>

        <!-- Dots Container -->
        <div id="particle-field"></div>

        <div class="bottom-label label" id="protocol-id">Ambiguity_Phase</div>

        <div class="readout-panel">
            <div class="readout">SYS::RECURSIVE_DAG_ACTIVE</div>
            <div class="readout">SYS::CORTEX_MONITOR_ON</div>
            <div class="readout">SYS::RFS_INTEGRITY_CHECK</div>
        </div>

    </div>

    <script>
        const field = document.getElementById('particle-field');
        const stage = document.getElementById('main-stage');
        const dots = [];
        const count = 49; // 7x7 grid

        // 1. Initial State: Particles off-screen
        function init() {
            for(let i=0; i<count; i++) {
                const d = document.createElement('div');
                d.className = 'dot';
                
                // Randomize starting side (Left or Right)
                const startLeft = Math.random() > 0.5 ? -100 : window.innerWidth + 100;
                const startTop = Math.random() * window.innerHeight;
                
                d.style.left = '0px';
                d.style.top = '0px';
                d.style.transform = `translate(${startLeft}px, ${startTop}px)`;
                
                field.appendChild(d);
                dots.push(d);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                runFullSequence();
            }
        });

        async function runFullSequence() {
            const status = document.getElementById('status-text');
            const proto = document.getElementById('protocol-id');

            // --- PHASE 1: FORMING ---
            // Particles rush in from sides to form central chaos
            stage.classList.add('forming');
            dots.forEach(d => {
                const noiseX = (window.innerWidth / 2) + (Math.random() - 0.5) * 400;
                const noiseY = (window.innerHeight / 2) + (Math.random() - 0.5) * 400;
                d.style.transform = `translate(${noiseX}px, ${noiseY}px)`;
            });

            // PAUSE for "Agentic Future" line
            await wait(2500);

            // --- PHASE 2: SCANNING ---
            // VO: "Trust isn't a leap of faith..."
            stage.classList.add('scanning');
            status.innerText = "Initiating_Validation_Sweep...";

            await wait(1500);

            // --- PHASE 3: THE SNAP ---
            // VO: "...it's an engineering protocol."
            stage.classList.remove('scanning');
            stage.classList.add('locked');
            
            status.innerText = "Protocol_Verified::Deterministic";
            proto.innerText = "Engineering_Standard_v1.0";

            // Snap into 7x7 grid
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const spacing = 45;

            dots.forEach((d, i) => {
                const row = Math.floor(i / 7);
                const col = i % 7;
                const x = centerX + (col - 3) * spacing;
                const y = centerY + (row - 3) * spacing;
                
                d.style.background = 'var(--cyan)';
                d.style.boxShadow = '0 0 15px var(--cyan)';
                d.style.borderRadius = '0px'; // Become square/blocks
                d.style.transform = `translate(${x}px, ${y}px)`;
            });
        }

        function wait(ms) { return new Promise(res => setTimeout(res, ms)); }

        init();
    </script>
</body>
</html>